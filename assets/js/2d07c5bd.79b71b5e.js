"use strict";(self.webpackChunkwebsitev_2=self.webpackChunkwebsitev_2||[]).push([[5776],{11036:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var a=n(87462),s=(n(67294),n(3905));const r={title:".NET SDK",slug:"/reference/sdks/dotnet"},i=void 0,o={unversionedId:"generated/sdks/server-side/dotnet",id:"generated/sdks/server-side/dotnet",title:".NET SDK",description:"This document was generated from the README in the .NET SDK's GitHub repository.",source:"@site/docs/generated/sdks/server-side/dotnet.md",sourceDirName:"generated/sdks/server-side",slug:"/reference/sdks/dotnet",permalink:"/reference/sdks/dotnet",draft:!1,editUrl:"https://github.com/Unleash/unleash/edit/main/website/docs/generated/sdks/server-side/dotnet.md",tags:[],version:"current",frontMatter:{title:".NET SDK",slug:"/reference/sdks/dotnet"},sidebar:"documentation",previous:{title:"SDK overview",permalink:"/reference/sdks/"},next:{title:"Go SDK",permalink:"/reference/sdks/go"}},l={},p=[{value:"Introduction",id:"introduction",level:2},{value:"Features",id:"features",level:2},{value:"Getting started",id:"getting-started",level:2},{value:"Create a new a Unleash instance",id:"create-a-new-a-unleash-instance",level:3},{value:"Handling events",id:"handling-events",level:3},{value:"Configuring projects in unleash client",id:"configuring-projects-in-unleash-client",level:3},{value:"Feature toggle api",id:"feature-toggle-api",level:3},{value:"Activation strategies",id:"activation-strategies",level:3},{value:"Custom strategies",id:"custom-strategies",level:4},{value:"Unleash context",id:"unleash-context",level:3},{value:"UnleashContextProvider",id:"unleashcontextprovider",level:4},{value:"Custom HTTP headers",id:"custom-http-headers",level:3},{value:"HttpMessageHandlers/Custom HttpClient initialization",id:"httpmessagehandlerscustom-httpclient-initialization",level:3},{value:"Dynamic custom HTTP headers",id:"dynamic-custom-http-headers",level:3},{value:"Local backup",id:"local-backup",level:2},{value:"Bootstrapping",id:"bootstrapping",level:2},{value:"Provided Bootstrappers",id:"provided-bootstrappers",level:3},{value:"ToggleBootstrapFileProvider",id:"togglebootstrapfileprovider",level:4},{value:"ToggleBootstrapUrlProvider",id:"togglebootstrapurlprovider",level:4},{value:"Json Serialization",id:"json-serialization",level:2},{value:"Synchronous Startup",id:"synchronous-startup",level:2},{value:"Run unleash server with Docker locally",id:"run-unleash-server-with-docker-locally",level:2},{value:"Development",id:"development",level:2}],u={toc:p};function d(e){let{components:t,...n}=e;return(0,s.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("admonition",{title:"Generated content",type:"info"},(0,s.kt)("p",{parentName:"admonition"},"This document was generated from the README in the ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/Unleash/unleash-client-dotnet"},".NET SDK's GitHub repository"),".")),(0,s.kt)("admonition",{title:"Connecting to Unleash",type:"tip"},(0,s.kt)("p",{parentName:"admonition"},"To connect to Unleash, you'll need your Unleash API url (e.g. ",(0,s.kt)("inlineCode",{parentName:"p"},"https://<your-unleash>/api"),") and a ",(0,s.kt)("a",{parentName:"p",href:"/reference/api-tokens-and-client-keys#client-tokens"},"server-side API token")," (",(0,s.kt)("a",{parentName:"p",href:"/how-to/how-to-create-api-tokens"},"how do I create an API token?"),").")),(0,s.kt)("h1",{id:"unleash-featuretoggle-client-for-net"},"Unleash FeatureToggle Client for .Net"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://github.com/Unleash/unleash-client-dotnet/blob/main/code-of-conduct.md"},(0,s.kt)("img",{parentName:"a",src:"https://img.shields.io/badge/Contributor%20Covenant-v1.4%20adopted-ff69b4.svg",alt:"Contributor Covenant"})),"\n",(0,s.kt)("a",{parentName:"p",href:"https://www.nuget.org/packages/Unleash.Client/"},(0,s.kt)("img",{parentName:"a",src:"https://img.shields.io/nuget/v/Unleash.Client.svg",alt:"NuGet"}))),(0,s.kt)("h2",{id:"introduction"},"Introduction"),(0,s.kt)("p",null,"Unleash Client SDK for .Net. It is compatible with the\n",(0,s.kt)("a",{parentName:"p",href:"https://www.unleash-hosted.com/"},"Unleash-hosted.com SaaS offering")," and\n",(0,s.kt)("a",{parentName:"p",href:"https://github.com/finn-no/unleash"},"Unleash Open-Source"),"."),(0,s.kt)("p",null,"The main motivation for doing feature toggling is to decouple the process for deploying code to production and releasing new features. This helps reducing risk, and allow us to easily manage which features to enable."),(0,s.kt)("p",null,"Feature toggles decouple deployment of code from release of new features."),(0,s.kt)("p",null,"Take a look at the demonstration site at ",(0,s.kt)("a",{parentName:"p",href:"http://unleash.herokuapp.com/"},"unleash.herokuapp.com")),(0,s.kt)("p",null,"Read more of the main project at ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/Unleash/unleash"},"github.com/unleash/unleash")),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://raw.githubusercontent.com/stiano/unleash-client-dotnet/master/resources/dashboard.png",alt:"dashboard",title:"Unleash Server Dashboard"})),(0,s.kt)("h2",{id:"features"},"Features"),(0,s.kt)("p",null,"Supported Frameworks"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"NET Standard 2.0"),(0,s.kt)("li",{parentName:"ul"},".Net 4.7"),(0,s.kt)("li",{parentName:"ul"},".Net 4.6.1"),(0,s.kt)("li",{parentName:"ul"},".Net 4.6"),(0,s.kt)("li",{parentName:"ul"},".Net 4.5.1"),(0,s.kt)("li",{parentName:"ul"},".Net 4.5")),(0,s.kt)("p",null,"No direct dependencies"),(0,s.kt)("p",null,"Extendable architecture"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Inject your own implementations of key components (Json serializer, background task scheduler, http client factory)")),(0,s.kt)("h2",{id:"getting-started"},"Getting started"),(0,s.kt)("p",null,"Install the latest version of ",(0,s.kt)("inlineCode",{parentName:"p"},"Unleash.Client")," from ",(0,s.kt)("a",{parentName:"p",href:"https://www.nuget.org/packages/Unleash.Client/"},"nuget.org"),"."),(0,s.kt)("h3",{id:"create-a-new-a-unleash-instance"},"Create a new a Unleash instance"),(0,s.kt)("p",null,"It is easy to get a new instance of Unleash. In your app you typically ",(0,s.kt)("em",{parentName:"p"},"just want one instance of Unleash"),", and inject that where you need it. You will typically use a dependency injection frameworks to manage this. "),(0,s.kt)("p",null,"To create a new instance of Unleash you need to pass in a settings object:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'\nvar settings = new UnleashSettings()\n{\n    AppName = "dotnet-test",\n    InstanceTag = "instance z",\n    UnleashApi = new Uri("http://unleash.herokuapp.com/api/"),\n    CustomHttpHeaders = new Dictionary()\n    {\n      {"Authorization","API token" }\n    }\n};\n\nvar unleash = new DefaultUnleash(settings);\n\n// Add to Container as Singleton\n// .NET Core 3/.NET 5/...\nservices.AddSingleton<IUnleash>(c => unleash);\n\n')),(0,s.kt)("p",null,"Unleash will attempt to log a warning for each new instance after instance count reaches 10.\nAlso note that the ",(0,s.kt)("inlineCode",{parentName:"p"},"DefaultUnleash")," constructor sets up the toggle caching and periodic background fetching. If you want the cache to be populated immediately, see the ",(0,s.kt)("a",{parentName:"p",href:"#synchronous-startup"},"synchronous startup")," section"),(0,s.kt)("p",null,"When your application shuts down, remember to dispose the unleash instance."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},"unleash?.Dispose()\n")),(0,s.kt)("h3",{id:"handling-events"},"Handling events"),(0,s.kt)("p",null,"Currently supported events:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://docs.getunleash.io/advanced/impression-data#impression-event-data"},"Impression data events"))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'\nvar settings = new UnleashSettings()\n{\n    // ...\n};\n\nvar unleash = new DefaultUnleash(settings);\n\n// Set up handling of impression events\nunleash.ConfigureEvents(cfg =>\n{\n    cfg.ImpressionEvent = evt => { Console.WriteLine($"{evt.FeatureName}: {evt.Enabled}"); };\n});\n\n')),(0,s.kt)("h3",{id:"configuring-projects-in-unleash-client"},"Configuring projects in unleash client"),(0,s.kt)("p",null,"If you're organizing your feature toggles in ",(0,s.kt)("inlineCode",{parentName:"p"},"Projects")," in Unleash Enterprise, you can specify the ",(0,s.kt)("inlineCode",{parentName:"p"},"ProjectId")," on the ",(0,s.kt)("inlineCode",{parentName:"p"},"UnleashSettings")," to select which project to fetch feature toggles for."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'\nvar settings = new UnleashSettings()\n{\n    AppName = "dotnet-test",\n    InstanceTag = "instance z",\n    UnleashApi = new Uri("http://unleash.herokuapp.com/api/"),\n    ProjectId = "projectId"\n};\n\n')),(0,s.kt)("h3",{id:"feature-toggle-api"},"Feature toggle api"),(0,s.kt)("p",null,"It is really simple to use unleash."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'if(unleash.IsEnabled("SuperAwesomeFeature")) \n{\n  //do some magic\n} \nelse \n{\n  //do old boring stuff\n}\n')),(0,s.kt)("p",null,"Calling ",(0,s.kt)("inlineCode",{parentName:"p"},'unleash.IsEnabled("SuperAwesomeFeature")')," is the equvivalent of calling ",(0,s.kt)("inlineCode",{parentName:"p"},'unleash.IsEnabled("SuperAwesomeFeature", false)'),".\nWhich means that it will return ",(0,s.kt)("inlineCode",{parentName:"p"},"false")," if it cannot find the named toggle. "),(0,s.kt)("p",null,"If you want it to default to ",(0,s.kt)("inlineCode",{parentName:"p"},"true")," instead, you can pass ",(0,s.kt)("inlineCode",{parentName:"p"},"true")," as the second argument:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'unleash.IsEnabled("SuperAwesomeFeature", true)\n')),(0,s.kt)("h3",{id:"activation-strategies"},"Activation strategies"),(0,s.kt)("p",null,"The .Net client comes with implementations for the built-in activation strategies provided by unleash. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"DefaultStrategy"),(0,s.kt)("li",{parentName:"ul"},"UserWithIdStrategy"),(0,s.kt)("li",{parentName:"ul"},"GradualRolloutRandomStrategy"),(0,s.kt)("li",{parentName:"ul"},"GradualRolloutUserWithIdStrategy"),(0,s.kt)("li",{parentName:"ul"},"GradualRolloutSessionIdStrategy"),(0,s.kt)("li",{parentName:"ul"},"RemoteAddressStrategy"),(0,s.kt)("li",{parentName:"ul"},"ApplicationHostnameStrategy"),(0,s.kt)("li",{parentName:"ul"},"FlexibleRolloutStrategy")),(0,s.kt)("p",null,"Read more about the strategies in ",(0,s.kt)("a",{parentName:"p",href:"https://docs.getunleash.io/user_guide/activation_strategy"},"activation-strategy.md"),"."),(0,s.kt)("h4",{id:"custom-strategies"},"Custom strategies"),(0,s.kt)("p",null,"You may also specify and implement your own strategies. The specification must be registered in the Unleash UI and you must register the strategy implementation when you wire up unleash. "),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},"IStrategy s1 = new MyAwesomeStrategy();\nIStrategy s2 = new MySuperAwesomeStrategy();\n\nIUnleash unleash = new DefaultUnleash(config, s1, s2);\n")),(0,s.kt)("h3",{id:"unleash-context"},"Unleash context"),(0,s.kt)("p",null,"In order to use some of the common activation strategies you must provide an ",(0,s.kt)("a",{parentName:"p",href:"https://docs.getunleash.io/user_guide/unleash_context"},"unleash-context"),"."),(0,s.kt)("p",null,"If you have configured custom stickiness and want to use that with the FlexibleRolloutStrategy or Variants, add the custom stickiness parameters to the Properties dictionary on the Unleash Context:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'HttpContext.Current.Items["UnleashContext"] = new UnleashContext\n{\n    UserId = HttpContext.Current.User?.Identity?.Name,\n    SessionId = HttpContext.Current.Session?.SessionID,\n    RemoteAddress = HttpContext.Current.Request.UserHostAddress,\n    Properties = new Dictionary<string, string>\n    {\n        // Obtain "customField" and add it to the context properties\n        { "customField", HttpContext.Current.Items["customField"].ToString() }\n    }\n};\n')),(0,s.kt)("h4",{id:"unleashcontextprovider"},"UnleashContextProvider"),(0,s.kt)("p",null,"The provider typically binds the context to the same thread as the request. If you are using Asp.Net the ",(0,s.kt)("inlineCode",{parentName:"p"},"UnleashContextProvider")," will typically be a 'request scoped' instance. "),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'public class AspNetContextProvider : IUnleashContextProvider\n{\n    public UnleashContext Context\n    {\n       get { return HttpContext.Current?.Items["UnleashContext"] as UnleashContext; }\n    }\n}\n\nprotected void Application_BeginRequest(object sender, EventArgs e)\n{\n    HttpContext.Current.Items["UnleashContext"] = new UnleashContext\n    {\n        UserId = HttpContext.Current.User?.Identity?.Name,\n        SessionId = HttpContext.Current.Session?.SessionID,\n        RemoteAddress = HttpContext.Current.Request.UserHostAddress,\n        Properties = new Dictionary<string, string>()\n        {\n            {"UserRoles", "A,B,C"}\n        }\n    };\n}\n\nvar settings = new UnleashSettings()\n{\n    AppName = "dotnet-test",\n    InstanceTag = "instance z",\n    UnleashApi = new Uri("http://unleash.herokuapp.com/api/"),\n    UnleashContextProvider = new AspNetContextProvider(),\n    CustomHttpHeaders = new Dictionary()\n    {\n      {"Authorization", "API token" }\n    }\n};\n')),(0,s.kt)("h3",{id:"custom-http-headers"},"Custom HTTP headers"),(0,s.kt)("p",null,"If you want the client to send custom HTTP Headers with all requests to the Unleash api you can define that by setting them via the ",(0,s.kt)("inlineCode",{parentName:"p"},"UnleashSettings"),". "),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'var settings = new UnleashSettings()\n{\n    AppName = "dotnet-test",\n    InstanceTag = "instance z",\n    UnleashApi = new Uri("http://unleash.herokuapp.com/api/"),\n    UnleashContextProvider = new AspNetContextProvider(),\n    CustomHttpHeaders = new Dictionary<string, string>()\n    {\n        {"Authorization", "API token" }\n    }\n};\n')),(0,s.kt)("h3",{id:"httpmessagehandlerscustom-httpclient-initialization"},"HttpMessageHandlers/Custom HttpClient initialization"),(0,s.kt)("p",null,"If you need to specify HttpMessageHandlers or to control the instantiation of the HttpClient, you can create a custom\nHttpClientFactory that inherits from DefaultHttpClientFactory, and override the method CreateHttpClientInstance.\nThen configure UnleashSettings to use your custom HttpClientFactory. "),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'internal class CustomHttpClientFactory : DefaultHttpClientFactory\n{\n    protected override HttpClient CreateHttpClientInstance(Uri unleashApiUri)\n    {\n        var messageHandler = new CustomHttpMessageHandler();\n        var httpClient = new HttpClient(messageHandler)\n        {\n            BaseAddress = apiUri,\n            Timeout = TimeSpan.FromSeconds(5)\n        };\n    }\n}\n\nvar settings = new UnleashSettings\n{\n    AppName = "dotnet-test",\n    //...\n    HttpClientFactory = new CustomHttpClientFactory()\n};\n')),(0,s.kt)("h3",{id:"dynamic-custom-http-headers"},"Dynamic custom HTTP headers"),(0,s.kt)("p",null,"If you need custom http headers that change during the lifetime of the client, a provider can be defined via the ",(0,s.kt)("inlineCode",{parentName:"p"},"UnleashSettings"),". "),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-vb"},'Public Class CustomHttpHeaderProvider\n    Implements IUnleashCustomHttpHeaderProvider\n\n    Public Function GetCustomHeaders() As Dictionary(Of String, String) Implements IUnleashCustomHttpHeaderProvider.GetCustomHeaders\n        Dim token = \' Acquire or refresh a token\n        Return New Dictionary(Of String, String) From\n                {{"Authorization", "Bearer " & token}}\n    End Function\nEnd Class\n\n\' ...\n\nDim unleashSettings As New UnleashSettings()\nunleashSettings.AppName = "dotnet-test"\nunleashSettings.InstanceTag = "instance z"\n\' add the custom http header provider to the settings\nunleashSettings.UnleashCustomHttpHeaderProvider = New CustomHttpHeaderProvider()\nunleashSettings.UnleashApi = new Uri("http://unleash.herokuapp.com/api/")\nunleashSettings.UnleashContextProvider = New AspNetContextProvider()\nDim unleash = New DefaultUnleash(unleashSettings)\n                \n')),(0,s.kt)("h2",{id:"local-backup"},"Local backup"),(0,s.kt)("p",null,"By default unleash-client fetches the feature toggles from unleash-server every 20s, and stores the result in temporary .json file which is located in ",(0,s.kt)("inlineCode",{parentName:"p"},"System.IO.Path.GetTempPath()")," directory. This means that if the unleash-server becomes unavailable, the unleash-client will still be able to toggle the features based on the values stored in .json file. As a result of this, the second argument of ",(0,s.kt)("inlineCode",{parentName:"p"},"IsEnabled")," will be returned in two cases:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"When .json file does not exists"),(0,s.kt)("li",{parentName:"ul"},"When the named feature toggle does not exist in .json file")),(0,s.kt)("h2",{id:"bootstrapping"},"Bootstrapping"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Unleash supports bootstrapping from a JSON string."),(0,s.kt)("li",{parentName:"ul"},"Configure your own custom provider implementing the ",(0,s.kt)("inlineCode",{parentName:"li"},"IToggleBootstrapProvider")," interface's single method ",(0,s.kt)("inlineCode",{parentName:"li"},"ToggleCollection Read()"),".\nThis should return a ",(0,s.kt)("inlineCode",{parentName:"li"},"ToggleCollection"),". The ",(0,s.kt)("inlineCode",{parentName:"li"},"UnleashSettings.JsonSerializer")," can be used to deserialize a JSON string in the same format returned from ",(0,s.kt)("inlineCode",{parentName:"li"},"/api/client/features"),"."),(0,s.kt)("li",{parentName:"ul"},"Example bootstrap files can be found in the json files located in ",(0,s.kt)("a",{parentName:"li",href:"https://github.com/Unleash/unleash-client-dotnet/blob/main/tests/Unleash.Tests/App_Data"},"tests/Unleash.Tests/App_Data")),(0,s.kt)("li",{parentName:"ul"},"Our assumption is this can be use for applications deployed to ephemeral containers or more locked down file systems where Unleash's need to write the backup file is not desirable or possible."),(0,s.kt)("li",{parentName:"ul"},"Loading with bootstrapping defaults to override feature toggles loaded from Local Backup, this override can be switched off by setting the ",(0,s.kt)("inlineCode",{parentName:"li"},"UnleashSettings.ToggleOverride")," property to ",(0,s.kt)("inlineCode",{parentName:"li"},"false"))),(0,s.kt)("p",null,"Configuring with the UnleashSettings:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'var settings = new UnleashSettings()\n{\n    AppName = "dotnet-test",\n    InstanceTag = "instance z",\n    UnleashApi = new Uri("http://unleash.herokuapp.com/api/"),\n    CustomHttpHeaders = new Dictionary()\n    {\n      {"Authorization","API token" }\n    },\n    ToggleOverride = false, // Defaults to true\n    ToggleBootstrapProvider = new MyToggleBootstrapProvider() // A toggle bootstrap provider implementing IToggleBootstrapProvider here\n};\n')),(0,s.kt)("h3",{id:"provided-bootstrappers"},"Provided Bootstrappers"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Two ToggleBootstrapProviders are provided"),(0,s.kt)("li",{parentName:"ul"},"These are found in the ",(0,s.kt)("inlineCode",{parentName:"li"},"Unleash.Utilities"),":")),(0,s.kt)("h4",{id:"togglebootstrapfileprovider"},"ToggleBootstrapFileProvider"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Unleash comes with a ",(0,s.kt)("inlineCode",{parentName:"li"},"ToggleBootstrapFileProvider")," which implements the ",(0,s.kt)("inlineCode",{parentName:"li"},"IToggleBootstrapProvider")," interface."),(0,s.kt)("li",{parentName:"ul"},"Configure with ",(0,s.kt)("inlineCode",{parentName:"li"},"UnleashSettings")," helper method:")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'settings.UseBootstrapFileProvider("./path/to/file.json");\n')),(0,s.kt)("h4",{id:"togglebootstrapurlprovider"},"ToggleBootstrapUrlProvider"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"Unleash also comes with a ",(0,s.kt)("inlineCode",{parentName:"p"},"ToggleBootstrapUrlProvider")," which implements the ",(0,s.kt)("inlineCode",{parentName:"p"},"IToggleBootstrapProvider")," interface.")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"Fetches JSON from a webaddress using ",(0,s.kt)("inlineCode",{parentName:"p"},"HttpMethod.Get"))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"Configure with ",(0,s.kt)("inlineCode",{parentName:"p"},"UnleashSettings")," helper method:"))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'var shouldThrowOnError = true; // Throws for 500, 404, etc\nvar customHeaders = new Dictionary<string, string>()\n{\n    { "Authorization", "Bearer ABCdefg123" } // Or whichever set of headers would be required to GET this file\n}; // Defaults to null\nsettings.UseBootstrapUrlProvider("://domain.top/path/to/file.json", shouldThrowOnError, customHeaders);\n')),(0,s.kt)("h2",{id:"json-serialization"},"Json Serialization"),(0,s.kt)("p",null,"The unleash client is dependant on a json serialization library. If your application already have Newtonsoft.Json >= 9.0.1 installed, everything should work out of the box. If not, you will get an error message during startup telling you to implement an 'IJsonSerializer' interface, which needs to be added to the configuration."),(0,s.kt)("p",null,"With Newtonsoft.Json version 7.0.0.0, the following implementation can be used. For older versions, consider to upgrade."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'var settings = new UnleashSettings()\n{\n    AppName = "dotnet-test",\n    InstanceTag = "instance z",\n    UnleashApi = new Uri("http://unleash.herokuapp.com/api/"),\n    JsonSerializer = new NewtonsoftJson7Serializer()\n};\n\npublic class NewtonsoftJson7Serializer : IJsonSerializer\n{\n    private readonly Encoding utf8 = Encoding.UTF8;\n\n    private static readonly JsonSerializer Serializer = new JsonSerializer()\n    {\n        ContractResolver = new CamelCaseExceptDictionaryKeysResolver()\n    };\n\n    public T Deserialize<T>(Stream stream)\n    {\n        using (var streamReader = new StreamReader(stream, utf8))\n        using (var textReader = new JsonTextReader(streamReader))\n        {\n            return Serializer.Deserialize<T>(textReader);\n        }\n    }\n\n    public void Serialize<T>(Stream stream, T instance)\n    {\n        using (var writer = new StreamWriter(stream, utf8, 1024 * 4, leaveOpen: true))\n        using (var jsonWriter = new JsonTextWriter(writer))\n        {\n            Serializer.Serialize(jsonWriter, instance);\n            \n            jsonWriter.Flush();\n            stream.Position = 0;\n        }\n    }\n\n    class CamelCaseExceptDictionaryKeysResolver : CamelCasePropertyNamesContractResolver\n    {\n        protected override JsonDictionaryContract CreateDictionaryContract(Type objectType)\n        {\n            var contract = base.CreateDictionaryContract(objectType);\n\n            contract.DictionaryKeyResolver = propertyName =>\n            {\n                return propertyName;\n            };\n\n            return contract;\n        }\n    }\n}\n')),(0,s.kt)("p",null,"The server api needs camel cased json, but not for certain dictionary keys. The implementation can be naively validated by the ",(0,s.kt)("inlineCode",{parentName:"p"},"JsonSerializerTester.Assert")," function. (Work in progress)."),(0,s.kt)("h2",{id:"synchronous-startup"},"Synchronous Startup"),(0,s.kt)("p",null,"This unleash client does not throw any exceptions if the unleash server is unreachable. Also, fetching features will return the default value if the feature toggle cache has not yet been populated. In many situations it is perferable to throw an error than allow an application to startup with incorrect feature toggle values. In this case, we provice a client factory with the option for synchronous initialization. "),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-csharp"},'var settings = new UnleashSettings()\n{\n    AppName = "dotnet-test",\n    InstanceTag = "instance z",\n    UnleashApi = new Uri("https://app.unleash-hosted.com/demo/api/"),\n    CustomHttpHeaders = new Dictionary<string, string>(),\n    {\n       {"Authorization","56907a2fa53c1d16101d509a10b78e36190b0f918d9f122d" }\n    }\n};\nvar unleashFactory = new UnleashClientFactory();\n\nIUnleash unleash = await unleashFactory.CreateClientAsync(settings, synchronousInitialization: true);\n\n// this `unleash` has successfully fetched feature toggles and written them to its cache.\n// if network errors or disk permissions prevented this from happening, the above await would have thrown an exception\n\nvar awesome = unleash.IsEnabled("SuperAwesomeFeature");\n')),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"CreateClientAsync")," method was introduced in version 1.5.0, making the previous ",(0,s.kt)("inlineCode",{parentName:"p"},"Generate")," method obsolete. There's also a ",(0,s.kt)("inlineCode",{parentName:"p"},"CreateClient")," method available if you don't prefer the async version."),(0,s.kt)("h2",{id:"run-unleash-server-with-docker-locally"},"Run unleash server with Docker locally"),(0,s.kt)("p",null,"The Unleash team have made a separate project which runs unleash server inside docker. Please see ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/Unleash/unleash-docker"},"unleash-docker")," for more details."),(0,s.kt)("h2",{id:"development"},"Development"),(0,s.kt)("p",null,"Visual Studio 2017 / Code"),(0,s.kt)("p",null,"Cakebuild"),(0,s.kt)("hr",null),(0,s.kt)("p",null,"This content was generated on ",(0,s.kt)("time",{datetime:"2023-01-13T11:41:42.283Z"},"13 January 2023 at 11:41:42 Coordinated Universal Time")))}d.isMDXComponent=!0}}]);