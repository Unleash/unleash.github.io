"use strict";(self.webpackChunkwebsitev_2=self.webpackChunkwebsitev_2||[]).push([[9500],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>d});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var o=n.createContext({}),h=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=h(e.components);return n.createElement(o.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=h(a),d=i,v=p["".concat(o,".").concat(d)]||p[d]||c[d]||r;return a?n.createElement(v,l(l({ref:t},u),{},{components:a})):n.createElement(v,l({ref:t},u))}));function d(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,l=new Array(r);l[0]=p;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s.mdxType="string"==typeof e?e:i,l[1]=s;for(var h=2;h<r;h++)l[h]=a[h];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},4771:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>o});var n=a(7462),i=(a(7294),a(3905));const r={id:"toggle_variants",title:"Feature Toggle Variants"},l=void 0,s={unversionedId:"advanced/toggle_variants",id:"advanced/toggle_variants",title:"Feature Toggle Variants",description:"Feature toggle variants were introduced in Unleash v3.2.0.",source:"@site/docs/advanced/feature-toggle-variants.md",sourceDirName:"advanced",slug:"/advanced/toggle_variants",permalink:"/advanced/toggle_variants",editUrl:"https://github.com/Unleash/unleash/edit/main/website/docs/advanced/feature-toggle-variants.md",tags:[],version:"current",frontMatter:{id:"toggle_variants",title:"Feature Toggle Variants"},sidebar:"documentation",previous:{title:"Feature Toggle Types",permalink:"/advanced/feature_toggle_types"},next:{title:"Projects",permalink:"/user_guide/projects"}},o=[{value:"What are variants?",id:"what-are-variants",children:[{value:"Variant weight",id:"variant-weight",children:[{value:"Weight types and calculation",id:"weight-types-and-calculation",children:[],level:4},{value:"Overrides",id:"overrides",children:[],level:4}],level:3},{value:"Variant payload",id:"variant-payload",children:[],level:3},{value:"Variant stickiness",id:"variant-stickiness",children:[],level:3}],level:2},{value:"How do I configure variants",id:"how-do-i-configure-variants",children:[],level:2},{value:"The <code>disabled</code> variant",id:"the-disabled-variant",children:[],level:2},{value:"Client SDK Support",id:"client-sdk-support",children:[],level:2}],h={toc:o};function u(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,n.Z)({},h,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{class:"alert alert--info",role:"alert"},(0,i.kt)("em",null,"Feature toggle variants")," were introduced in ",(0,i.kt)("em",null,"Unleash v3.2.0"),"."),(0,i.kt)("br",null),(0,i.kt)("p",null,"Every toggle in Unleash can have something called ",(0,i.kt)("em",{parentName:"p"},"variants"),". Where ",(0,i.kt)("em",{parentName:"p"},"feature toggles")," allow you to decide which users get access to a feature, ",(0,i.kt)("em",{parentName:"p"},"toggle variants")," allow you to further split those users into segments. Say, for instance, that you're testing out a new feature, such as an alternate sign-up form. The feature toggle would expose the form only to a select group of users. The variants could decide whether the user sees a blue or a green submit button on that form."),(0,i.kt)("p",null,"Variants facilitate A/B testing and experimentation by letting you create controlled and measurable experiments. Check ",(0,i.kt)("a",{parentName:"p",href:"https://www.getunleash.io/blog/a-b-n-experiments-in-3-simple-steps"},"our blog post on using Unleash for A/B/n experiments")," for some more insights into how you can set it up."),(0,i.kt)("h2",{id:"what-are-variants"},"What are variants?"),(0,i.kt)("p",null,"Whenever you create a feature toggle, you can assign it any number of ",(0,i.kt)("em",{parentName:"p"},"variants"),". This is commonly done in cases where you want to serve your users different versions of a feature to see which performs better."),(0,i.kt)("p",null,"A variant has four components that define it:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"a ",(0,i.kt)("strong",{parentName:"p"},"name"),":"),(0,i.kt)("p",{parentName:"li"},"  This must be unique among the toggle's variants. When working with a toggle with variants in a client, you will typically use the variant's name to find out which variant it is.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"a ",(0,i.kt)("strong",{parentName:"p"},"weight"),":"),(0,i.kt)("p",{parentName:"li"},"  The weight is the likelihood of any one user getting this specific variant. See the ",(0,i.kt)("a",{parentName:"p",href:"#variant-weight"},"weights section")," for more info.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"an optional ",(0,i.kt)("strong",{parentName:"p"},"payload"),":"),(0,i.kt)("p",{parentName:"li"},"  A variant can also have an associated payload. Use this to deliver more data or context. See the ",(0,i.kt)("a",{parentName:"p",href:"#variant-payload"},"payload section")," for a more details."))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"an optional ",(0,i.kt)("strong",{parentName:"p"},"override")),(0,i.kt)("p",{parentName:"li"},"  Overrides let you specify that certain users (as identified either by their user ID or by another ",(0,i.kt)("a",{parentName:"p",href:"stickiness"},"custom stickiness")," value) will always get this variant, regardless of the variant's weight."))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"A form for adding new variants. It has fields for name, weight, payload, and overrides.",src:a(5398).Z,title:"Creating a new toggle variant",width:"1515",height:"962"})),(0,i.kt)("h3",{id:"variant-weight"},"Variant weight"),(0,i.kt)("p",null,"A variant's weight determines how likely it is that a user will receive that variant. It is a numeric value between 0 and 100 (inclusive) with one decimal's worth of precision."),(0,i.kt)("p",null,"When you have multiple variants, the sum of all their weights must add up to exactly 100. Depending on the ",(0,i.kt)("a",{parentName:"p",href:"#weight-types"},"weight type"),", Unleash may automatically determine the weight of the new variant and balance it out with the other variants."),(0,i.kt)("h4",{id:"weight-types-and-calculation"},"Weight types and calculation"),(0,i.kt)("p",null,"There are two kinds of variant weight types: ",(0,i.kt)("em",{parentName:"p"},"variable")," and ",(0,i.kt)("em",{parentName:"p"},"fixed"),". Unleash requires you to always have ",(0,i.kt)("em",{parentName:"p"},"at least")," one variable weight variant."),(0,i.kt)("p",null,"The default weight type is ",(0,i.kt)("em",{parentName:"p"},"variable"),". Variable weight variants will adjust their weight based on the number of other variable weight variants and whatever weight is not used up by fixed weight variants."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Fixed")," weight variants have a set weight which will not change. All fixed weight variants' weights can not add up to more than 100."),(0,i.kt)("p",null,"To calculate what the weight of a variable weight variant is, Unleash first subtracts the sum of fixed weights from 100 and then distributes the remaining weight evenly among the variable weight variants."),(0,i.kt)("p",null,"For instance, if you have three variable weight variants and two fixed weight variants weighted at 25 and 15 respectively, Unleash will:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Subtract the fixed weight from the total available: 100 - 40 = 60"),(0,i.kt)("li",{parentName:"ol"},"Divide the remainder by the number of variable weight variants: 60 / 3 = 20"),(0,i.kt)("li",{parentName:"ol"},"Assign each variable weight variant the same (up to rounding differences) weight: 20%")),(0,i.kt)("p",null,"In the example above, 60 divides cleanly by three. In cases where the remainder doesn't divide evenly among the variable weight variants, Unleash will distribute it as evenly as it can to one decimal's precision. If you have three variable weight variants, they will be weighted at 33.4, 33.3, and 33.3 respectively, so that it adds up to 100.0."),(0,i.kt)("h4",{id:"overrides"},"Overrides"),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Overrides are intended to be used for one-off cases and during development and may not be suitable for other use cases."))),(0,i.kt)("p",null,"The weighting system automatically assigns users to a specific group for you. If you want to make sure that a specific user or group of users receives a certain variant, though, you can use the override functionality to achieve that."),(0,i.kt)("p",null,"When adding an override, you choose a ",(0,i.kt)("a",{parentName:"p",href:"../user_guide/unleash_context"},"field from the Unleash Context")," and specify that if a context contains one of a given list of values, then the current variant should always activate."),(0,i.kt)("p",null,"You can use both standard and custom context fields when creating overrides."),(0,i.kt)("p",null,"Each variant can have multiple overrides, so you can use any number of context fields you want to create overrides. When using multiple overrides, each user only has to match one of them. In other words, if you use the following overrides, the users with IDs ",(0,i.kt)("em",{parentName:"p"},"aa599")," and ",(0,i.kt)("em",{parentName:"p"},"aa65")," ",(0,i.kt)("strong",{parentName:"p"},"and")," any users who use the client with ID ",(0,i.kt)("em",{parentName:"p"},"123abc")," will receive the specified variant:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"userId"),": aa599, aa65"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"clientId"),": 123abc")),(0,i.kt)("p",null,"Note that if multiple variants use overrides that affect the same user, then Unleash can not guarantee which override will take effect. We recommend that you do not use multiple overrides that can conflict in this way, as it will probably not do what you expect."),(0,i.kt)("h3",{id:"variant-payload"},"Variant payload"),(0,i.kt)("p",null,"Each variant can have an associated payload. Use this to add more context or data to a payload that you can access on the client, such as a customized message or other information."),(0,i.kt)("p",null,"Unleash currently supports these payload types:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"JSON"),(0,i.kt)("li",{parentName:"ul"},"CSV"),(0,i.kt)("li",{parentName:"ul"},"String")),(0,i.kt)("h3",{id:"variant-stickiness"},"Variant stickiness"),(0,i.kt)("p",null,"Variant stickiness is calculated on the received user and context, as described in ",(0,i.kt)("a",{parentName:"p",href:"stickiness"},"the stickiness chapter"),". This ensures that the same user will consistently see the same variant barring overrides and weight changes. If no context data is provided, the traffic will be spread randomly for each request."),(0,i.kt)("h2",{id:"how-do-i-configure-variants"},"How do I configure variants"),(0,i.kt)("p",null,"In the Unleash UI, you can configure variants by navigating to the feature view, and then choosing the 'Variants' tab."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"toggle_variants",src:a(6613).Z,title:"Feature Toggle Variants",width:"2032",height:"1377"})),(0,i.kt)("h2",{id:"the-disabled-variant"},"The ",(0,i.kt)("inlineCode",{parentName:"h2"},"disabled")," variant"),(0,i.kt)("p",null,"When a toggle has no variants or when a toggle is disabled for a user, Unleash will return it with variant data that looks like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "disabled",\n  "enabled": false\n}\n')),(0,i.kt)("p",null,"This is a fallback variant that Unleash uses to represent the lack of a variant."),(0,i.kt)("p",null,"Note: The actual representation of the built-in fallback variant in the client SDK will vary slightly, to honor best practices in various languages."),(0,i.kt)("h2",{id:"client-sdk-support"},"Client SDK Support"),(0,i.kt)("p",null,"To make use of toggle variants, you need to use a compatible client. Client SDK with variant support:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/Unleash/unleash-client-node"},"unleash-client-node")," (from v3.2.0)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/Unleash/unleash-client-java"},"unleash-client-java")," (from v3.2.0)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/Unleash/unleash-client-ruby"},"unleash-client-ruby")," (from v0.1.6)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/Unleash/unleash-client-python"},"unleash-client-python")," (from v3.3.0)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/Unleash/unleash-client-dotnet"},"unleash-client-dotnet")," (from v1.3.6)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/Unleash/unleash-client-go"},"unleash-client-go")," (from v3 branch)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/Unleash/unleash-client-php"},"unleash-client-php")," (from v1.0.0)")),(0,i.kt)("p",null,"If you would like to give feedback on this feature, experience issues or have questions, please feel free to open an issue on ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Unleash/unleash/"},"GitHub"),"."))}u.isMDXComponent=!0},5398:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/variant-creation-form-944d104eeb3424be7394e95b0230a352.png"},6613:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/variants-7f715476b7cdbfb47b823373dff34780.png"}}]);