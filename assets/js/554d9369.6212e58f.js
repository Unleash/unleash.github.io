"use strict";(self.webpackChunkwebsitev_2=self.webpackChunkwebsitev_2||[]).push([[54279],{70977:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>m});var o=n(87462),a=(n(67294),n(3905));const i={id:"environments",title:"Environments"},r=void 0,l={unversionedId:"reference/environments",id:"reference/environments",title:"Environments",description:"Environments were released in Unleash v4.3.0.",source:"@site/docs/reference/environments.md",sourceDirName:"reference",slug:"/reference/environments",permalink:"/reference/environments",draft:!1,editUrl:"https://github.com/Unleash/unleash/edit/main/website/docs/reference/environments.md",tags:[],version:"current",frontMatter:{id:"environments",title:"Environments"},sidebar:"documentation",previous:{title:"Custom Activation Strategies",permalink:"/reference/custom-activation-strategies"},next:{title:"Strategy Variants",permalink:"/reference/strategy-variants"}},s={},m=[{value:"Environment types",id:"environment-types",level:2},{value:"Global and project-level environments",id:"global-and-project-level-environments",level:2},{value:"How to start using environments",id:"how-to-start-using-environments",level:2},{value:"Step 1: Enable new environments for your Project",id:"step-1-enable-new-environments-for-your-project",level:3},{value:"Step 2: Configure activation strategies for the new environment",id:"step-2-configure-activation-strategies-for-the-new-environment",level:3},{value:"Step 3: Create environment specific API keys",id:"step-3-create-environment-specific-api-keys",level:3},{value:"Cloning environments",id:"cloning-environments",level:2},{value:"Migration",id:"migration",level:2},{value:"Integrations",id:"integrations",level:3},{value:"API",id:"api",level:3},{value:"Plan Differences",id:"plan-differences",level:2},{value:"Open-Source (free)",id:"open-source-free",level:3},{value:"Pro (commercial)",id:"pro-commercial",level:3},{value:"Enterprise (commercial)",id:"enterprise-commercial",level:3},{value:"Rollout Plan",id:"rollout-plan",level:2}],u={toc:m};function p(e){let{components:t,...i}=e;return(0,a.kt)("wrapper",(0,o.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("admonition",{title:"Availability",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Environments were released in Unleash v4.3.0.")),(0,a.kt)("div",{style:{position:"relative",paddingBottom:"56.25%",height:"0"}},(0,a.kt)("iframe",{src:"https://www.loom.com/embed/95239e875bbc4e09a5c5833e1942e4b0",frameborder:"0",webkitallowfullscreen:!0,mozallowfullscreen:!0,allowfullscreen:!0,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}})),(0,a.kt)("p",null,"Environments is a new way to organize activation strategy configurations for feature toggles into separate environments. In Unleash, a feature lives across all your environments \u2014 after all, the goal is to get the new feature released as soon as possible \u2014 but it makes sense to configure the activation differently per environment. You might want the feature enabled for everyone in development, but only for yourself in production, for instance."),(0,a.kt)("p",null,"Previously, Unleash Enterprise could use ",(0,a.kt)("a",{parentName:"p",href:"/reference/strategy-constraints"},"strategy constraints")," to control the rollout across environments. With the new environments feature, this is no longer necessary. Now all activation strategies belong to an explicit environment instead."),(0,a.kt)("p",null,"Further, connected applications will use environment-scoped API keys to make sure they only download feature toggle configurations for the environment they are running in."),(0,a.kt)("p",null,"Finally, metrics have also been upgraded to record the environment. This, in turn, means that Unleash can display usage metrics per environment."),(0,a.kt)("p",null,'Despite this being a shift in how Unleash works, everything will continue to work exactly how it did for existing users. For backwards compatibility, we have created an environment named "default" that will contain all of the existing toggles and API keys. Read more about that in ',(0,a.kt)("a",{parentName:"p",href:"#migration"},"the migration section"),"."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"A graph showing how environments work. Each project can have multiple features, and each feature can have different activation strategies in each of its environments.",src:n(2656).Z,title:"A feature toggle exists across all environments, but take different activation strategies per environment.",width:"718",height:"508"})),(0,a.kt)("h2",{id:"environment-types"},"Environment types"),(0,a.kt)("p",null,"All environments in Unleash have a ",(0,a.kt)("strong",{parentName:"p"},"type"),". When you create a new environment, you must also assign it a type."),(0,a.kt)("p",null,"The built-in environment types are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Development"),(0,a.kt)("li",{parentName:"ul"},"Test"),(0,a.kt)("li",{parentName:"ul"},"Pre-production"),(0,a.kt)("li",{parentName:"ul"},"Production")),(0,a.kt)("p",null,"The ",(0,a.kt)("strong",{parentName:"p"},"production"),' environment type is special: Unleash will show additional confirmation prompts when you change something that could impact users in environments of this type. The built-in "production" environment is a production-type environment.'),(0,a.kt)("p",null,"The other environment types do not currently have any functionality associated with them. This may change in the future."),(0,a.kt)("h2",{id:"global-and-project-level-environments"},"Global and project-level environments"),(0,a.kt)("p",null,"Environments exist on a global level, so they are available to all projects within Unleash. However, every ",(0,a.kt)("a",{parentName:"p",href:"/reference/projects"},"project")," might not need to use every environment. That's why you can also choose which of the global environments should be available within a project."),(0,a.kt)("h2",{id:"how-to-start-using-environments"},"How to start using environments"),(0,a.kt)("p",null,"In order to start using environments you need to be on Unleash v4.2 or higher."),(0,a.kt)("p",null,"If you are on v4.2, you also need to have the environment feature enabled (if you are using Unleash Hosted, please reach out on ",(0,a.kt)("a",{parentName:"p",href:"mailto:contact@getunleash.io"},"contact@getunleash.io")," if you want to start using environments."),(0,a.kt)("p",null,"If you are on v4.3 or later, environments are already enabled for you."),(0,a.kt)("p",null,"Note that in order to enable an environment for a feature toggle, you must first add activation strategies for that environment. You cannot enable an environment without activation strategies."),(0,a.kt)("h3",{id:"step-1-enable-new-environments-for-your-project"},"Step 1: Enable new environments for your Project"),(0,a.kt)("p",null,"Navigate to the project and choose the \u201cenvironments\u201d tab."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"A project view showing the Environments tab. The UI displays three environment toggles: &quot;default&quot;, &quot;development&quot;, and &quot;production&quot;. The &quot;default&quot; environment is enabled.",src:n(93023).Z,title:"Configure environment for this project",width:"1366",height:"730"})),(0,a.kt)("h3",{id:"step-2-configure-activation-strategies-for-the-new-environment"},"Step 2: Configure activation strategies for the new environment"),(0,a.kt)("p",null,"From the \u201cfeature toggle view\u201d you will now be able to configure activation strategies per environment. You can also enable and disable environments here. Remember that an environment must have activation strategies before you can enable it."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"A feature toggle strategies tab showing three different environments, of which one is active. The UI displays data about the currently selected environment, ",src:n(82981).Z,title:"Add strategy configuration per environment",width:"1366",height:"1611"})),(0,a.kt)("h3",{id:"step-3-create-environment-specific-api-keys"},"Step 3: Create environment specific API keys"),(0,a.kt)("p",null,"In order for the SDK to download the feature toggle configuration for the correct environment you will need to create an API token for a defined environment."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"An API key creation form. The form&#39;s fields are &quot;username&quot;, &quot;token type&quot;, &quot;project&quot;, and, crucially, &quot;environment&quot;. The development environment is selected.",src:n(31507).Z,title:"Create Environment specific API Keys",width:"1366",height:"1196"})),(0,a.kt)("h2",{id:"cloning-environments"},"Cloning environments"),(0,a.kt)("admonition",{title:"Availability",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Environment cloning was made available in Unleash 4.19.")),(0,a.kt)("p",null,"Unleash environments can be cloned. Cloning an environment creates a ",(0,a.kt)("strong",{parentName:"p"},"new")," environment based on the selected source environment. When cloning an environment, you select any number of projects whose feature toggle configurations will also be cloned. These projects will have identical configurations for the source and target environments. However, the environments can then be configured independently and will not stay in sync with each other."),(0,a.kt)("p",null,"When cloning an environment, you must give the new environment"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"a name"),(0,a.kt)("li",{parentName:"ul"},"an environment type"),(0,a.kt)("li",{parentName:"ul"},"a list of projects to clone feature configurations in")),(0,a.kt)("p",null,"You can also clone user permissions into the new environment. When you do that, permissions in the new environment will be the same as in the environment you cloned from. If you don't clone permissions, only admins and project editors can make changes in the new environment. You can change permissions after creation by using ",(0,a.kt)("a",{parentName:"p",href:"../reference/rbac#custom-project-roles"},"custom project roles"),"."),(0,a.kt)("p",null,"In order to clone an environment, you can follow the ",(0,a.kt)("a",{parentName:"p",href:"/how-to/how-to-clone-environments"},"how to clone environments")," guide."),(0,a.kt)("p",null,"Once created, the new environment works just as any other environment."),(0,a.kt)("h2",{id:"migration"},"Migration"),(0,a.kt)("p",null,"To ease migration we have created a special environment called \u201cdefault\u201d. All existing activation strategies have been added to this environment. All existing Client API keys have also been scoped to work against the default environment to ensure zero disruption as part of the upgrade."),(0,a.kt)("p",null,"If you're currently using strategy constraints together with the \u201cenvironment\u201d field on the Unleash Context, you should be aware that the new environment support works slightly differently. With environments, the SDK API will use the client's API key to determine which environment the client is configured for. The API then sends ",(0,a.kt)("em",{parentName:"p"},"only"),' strategies belonging to the client\'s environment. This means that you might not need the "environment" property of the Unleash Context anymore.'),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"A strategy constraint using the environment field of the unleash context.",src:n(20695).Z,title:"You will not use strategy constraints for environments any more.",width:"1366",height:"559"})),(0,a.kt)("h3",{id:"integrations"},"Integrations"),(0,a.kt)("p",null,"We have made some slight changes to events related to feature toggles: there's one deprecation and several new event types. Most of the new events contain ",(0,a.kt)("em",{parentName:"p"},"project")," and ",(0,a.kt)("em",{parentName:"p"},"environment")," data."),(0,a.kt)("p",null,"To avoid missing important updates, you will also need to update your integration configuration to subscribe to the new events."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Deprecated events:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"FEATURE_UPDATE")," - ",(0,a.kt)("em",{parentName:"li"},"not used after switching to environments"))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"New Events")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"FEATURE-METADATA-UPDATED")," - The feature toggle metadata was updated (across all environments)."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"FEATURE-STRATEGY-ADD"),"\xb9 - An activation strategy was added to a feature toggle in an environment. The ",(0,a.kt)("em",{parentName:"li"},"data")," will contain the updated strategy configuration."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"FEATURE-STRATEGY-UPDATE"),"\xb9 - An activation strategy was updated for a feature toggle. The ",(0,a.kt)("em",{parentName:"li"},"data")," will contain the updated strategy configuration."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"FEATURE-STRATEGY-REMOVE"),"\xb9 - An activation strategy was removed for a feature toggle."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"FEATURE-ENVIRONMENT-ENABLED"),"\xb9 - Signals that a feature toggle has been ",(0,a.kt)("em",{parentName:"li"},"enabled")," in a defined environment."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"FEATURE-ENVIRONMENT-DISABLED"),"\xb9 - Signals that a feature toggle has been ",(0,a.kt)("em",{parentName:"li"},"disabled")," in a defined environment."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"FEATURE-PROJECT-CHANGE"),"\xb9 - The feature toggle was moved to a new project.")),(0,a.kt)("blockquote",null,(0,a.kt)("ol",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ol"},"These feature events will contain ",(0,a.kt)("em",{parentName:"li"},"project")," and ",(0,a.kt)("em",{parentName:"li"},"environment")," as part of the event metadata."))),(0,a.kt)("h3",{id:"api"},"API"),(0,a.kt)("p",null,"In order to support configuration per environment we had to rebuild our feature toggle admin API to account for environments as well. This means that we're making the following changes to the API:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"/api/admin/features")," - ",(0,a.kt)("em",{parentName:"li"},"deprecated (scheduled for removal in Unleash v5.0). The ",(0,a.kt)("a",{parentName:"em",href:"/reference/api/legacy/unleash/admin/features"},"old feature toggles admin API")," still works, but strategy configuration will be assumed to target the \u201cdefault\u201d environment.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"/api/admin/projects/:projectId/features")," - New feature API to be used for feature toggles which also adds support for environments. See ",(0,a.kt)("a",{parentName:"li",href:"/reference/api/legacy/unleash/admin/features"},"the documentation")," to learn more.")),(0,a.kt)("h2",{id:"plan-differences"},"Plan Differences"),(0,a.kt)("h3",{id:"open-source-free"},"Open-Source (free)"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Will get access to two preconfigured environments: \u201cdevelopment\u201d and \u201cproduction\u201d. Existing users of Unleash will also get an additional \u201cdefault\u201d environment to simplify the adoption of environments."),(0,a.kt)("li",{parentName:"ul"},"Will be possible to turn environments on/off for all projects.")),(0,a.kt)("h3",{id:"pro-commercial"},"Pro (commercial)"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Will get access to two preconfigured environments: \u201cdevelopment\u201d and \u201cproduction\u201d. Existing users of Unleash will also get an additional \u201cdefault\u201d environment to simplify the adoption of environments."),(0,a.kt)("li",{parentName:"ul"},"Will be possible to turn environments on/off for the default project.")),(0,a.kt)("h3",{id:"enterprise-commercial"},"Enterprise (commercial)"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Will get access to two preconfigured environments: \u201cdevelopment\u201d and \u201cproduction\u201d. Existing users of Unleash will also get an additional \u201cdefault\u201d environment to simplify the adoption of environments."),(0,a.kt)("li",{parentName:"ul"},"Will be possible to turn environments on/off for all projects"),(0,a.kt)("li",{parentName:"ul"},"Will be allowed to update and remove environments."),(0,a.kt)("li",{parentName:"ul"},"Will be allowed to create new environments and clone existing environments.")),(0,a.kt)("h2",{id:"rollout-plan"},"Rollout Plan"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Unleash v4.2")," will provide ",(0,a.kt)("em",{parentName:"li"},"early access")," to environment support. This means that it can be enabled per customer via a feature flag."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Unleash v4.3")," plans to provide general access to the environment support for all users of Unleash (Open-Source, Pro, Enterprise).")))}p.isMDXComponent=!0},31507:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/environments_api_keys-261305ff6702ea86251bc83f3bd5a826.png"},93023:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/environments_configure-06c583012173865f2091068b1f826721.png"},2656:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/environments_overview-f02297b24677cdba3b8e3ceacfe86ba1.svg"},82981:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/environments_strategies-2a439d832f1feb9b4554ed397db0bbf4.png"},20695:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/environments_strategy_constraints-d30982247ffd07dbd65e46ff137d48fa.png"}}]);