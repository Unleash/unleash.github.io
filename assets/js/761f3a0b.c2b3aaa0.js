"use strict";(self.webpackChunkwebsitev_2=self.webpackChunkwebsitev_2||[]).push([[3137],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>d});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),p=u(n),d=o,v=p["".concat(s,".").concat(d)]||p[d]||c[d]||r;return n?a.createElement(v,i(i({ref:t},m),{},{components:n})):a.createElement(v,i({ref:t},m))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var u=2;u<r;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},744:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>u});var a=n(7462),o=(n(7294),n(3905));const r={id:"environments",title:"Environments"},i=void 0,l={unversionedId:"user_guide/environments",id:"user_guide/environments",title:"Environments",description:"Environments are available in Unleash v4.3.x and later. They can also be enabled from Unleash v4.2.x with a feature toggle.",source:"@site/docs/user_guide/environments.md",sourceDirName:"user_guide",slug:"/user_guide/environments",permalink:"/user_guide/environments",draft:!1,editUrl:"https://github.com/Unleash/unleash/edit/main/website/docs/user_guide/environments.md",tags:[],version:"current",frontMatter:{id:"environments",title:"Environments"},sidebar:"documentation",previous:{title:"Custom Activation Strategies",permalink:"/advanced/custom_activation_strategy"},next:{title:"Feature Toggles",permalink:"/reference/feature-toggles"}},s={},u=[{value:"Global and project-level environments",id:"global-and-project-level-environments",level:2},{value:"How to start using environments",id:"how-to-start-using-environments",level:2},{value:"Step 1: Enable new environments for your Project",id:"step-1-enable-new-environments-for-your-project",level:3},{value:"Step 2: Configure activation strategies for the new environment",id:"step-2-configure-activation-strategies-for-the-new-environment",level:3},{value:"Step 3: Create environment specific API keys",id:"step-3-create-environment-specific-api-keys",level:3},{value:"Migration",id:"migration",level:2},{value:"Addons",id:"addons",level:3},{value:"API",id:"api",level:3},{value:"Plan Differences",id:"plan-differences",level:2},{value:"Open-Source (free)",id:"open-source-free",level:3},{value:"Pro (commercial)",id:"pro-commercial",level:3},{value:"Enterprise (commercial)",id:"enterprise-commercial",level:3},{value:"Rollout Plan",id:"rollout-plan",level:2}],m={toc:u};function c(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,a.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("div",{class:"alert alert--info"},(0,o.kt)("em",null,"Environments")," are available in ",(0,o.kt)("i",null,"Unleash v4.3.x")," and later. They can also be enabled from ",(0,o.kt)("i",null,"Unleash v4.2.x")," with a feature toggle."),(0,o.kt)("br",null),(0,o.kt)("div",{style:{position:"relative",paddingBottom:"56.25%",height:"0"}},(0,o.kt)("iframe",{src:"https://www.loom.com/embed/95239e875bbc4e09a5c5833e1942e4b0",frameborder:"0",webkitallowfullscreen:!0,mozallowfullscreen:!0,allowfullscreen:!0,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}})),(0,o.kt)("p",null,"Environments is a new way to organize activation strategy configurations for feature toggles into separate environments. In Unleash, a feature lives across all your environments \u2014 after all, the goal is to get the new feature released as soon as possible \u2014 but it makes sense to configure the activation differently per environment. You might want the feature enabled for everyone in development, but only for yourself in production, for instance."),(0,o.kt)("p",null,"Previously, Unleash Enterprise could use ",(0,o.kt)("a",{parentName:"p",href:"/advanced/strategy_constraints"},"strategy constraints")," to control the rollout across environments. With the new environments feature, this is no longer necessary. Now all activation strategies belong to an explicit environment instead."),(0,o.kt)("p",null,"Further, connected applications will use environment-scoped API keys to make sure they only download feature toggle configurations for the environment they are running in."),(0,o.kt)("p",null,"Finally, metrics have also been upgraded to record the environment. This, in turn, means that Unleash can display usage metrics per environment."),(0,o.kt)("p",null,'Despite this being a shift in how Unleash works, everything will continue to work exactly how it did for existing users. For backwards compatibility, we have created an environment named "default" that will contain all of the existing toggles and API keys. Read more about that in ',(0,o.kt)("a",{parentName:"p",href:"#migration"},"the migration section"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"A graph showing how environments work. Each project can have multiple features, and each feature can have different activation strategies in each of its environments.",src:n(2656).Z,title:"A feature toggle exists across all environments, but take different activation strategies per environment.",width:"718",height:"508"})),(0,o.kt)("h2",{id:"global-and-project-level-environments"},"Global and project-level environments"),(0,o.kt)("p",null,"Environments exist on a global level, so they are available to all projects within Unleash. However, every ",(0,o.kt)("a",{parentName:"p",href:"/user_guide/projects"},"project")," might not need to use every environment. That's why you can also choose which of the global environments should be available within a project."),(0,o.kt)("h2",{id:"how-to-start-using-environments"},"How to start using environments"),(0,o.kt)("p",null,"In order to start using environments you need to be on Unleash v4.2 or higher."),(0,o.kt)("p",null,"If you are on v4.2, you also need to have the environment feature enabled (if you are using Unleash Hosted, please reach out on ",(0,o.kt)("a",{parentName:"p",href:"mailto:contact@getunleash.io"},"contact@getunleash.io")," if you want to start using environments."),(0,o.kt)("p",null,"If you are on v4.3 or later, environments are already enabled for you."),(0,o.kt)("p",null,"Note that in order to enable an environment for a feature toggle, you must first add activation strategies for that environment. You cannot enable an environment without activation strategies."),(0,o.kt)("h3",{id:"step-1-enable-new-environments-for-your-project"},"Step 1: Enable new environments for your Project"),(0,o.kt)("p",null,"Navigate to the project and choose the \u201cenvironments\u201d tab."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"A project view showing the Environments tab. The UI displays three environment toggles: &quot;default&quot;, &quot;development&quot;, and &quot;production&quot;. The &quot;default&quot; environment is enabled.",src:n(3023).Z,title:"Configure environment for this project",width:"1296",height:"777"})),(0,o.kt)("h3",{id:"step-2-configure-activation-strategies-for-the-new-environment"},"Step 2: Configure activation strategies for the new environment"),(0,o.kt)("p",null,"From the \u201cfeature toggle view\u201d you will now be able to configure activation strategies per environment. You can also enable and disable environments here. Remember that an environment must have activation strategies before you can enable it."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"A feature toggle strategies tab showing three different environments, of which one is active. The UI displays data about the currently selected environment, ",src:n(2981).Z,title:"Add strategy configuration per environment",width:"1830",height:"992"})),(0,o.kt)("h3",{id:"step-3-create-environment-specific-api-keys"},"Step 3: Create environment specific API keys"),(0,o.kt)("p",null,"In order for the SDK to download the feature toggle configuration for the correct environment you will need to create an API token for a defined environment."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"An API key creation form. The form&#39;s fields are &quot;username&quot;, &quot;token type&quot;, &quot;project&quot;, and, crucially, &quot;environment&quot;. The development environment is selected.",src:n(1507).Z,title:"Create Environment specific API Keys",width:"1284",height:"863"})),(0,o.kt)("h2",{id:"migration"},"Migration"),(0,o.kt)("p",null,"To ease migration we have created a special environment called \u201cdefault\u201d. All existing activation strategies have been added to this environment. All existing Client API keys have also been scoped to work against the default environment to ensure zero disruption as part of the upgrade."),(0,o.kt)("p",null,"If you're currently using strategy constraints together with the \u201cenvironment\u201d field on the Unleash Context, you should be aware that the new environment support works slightly differently. With environments, the SDK API will use the client's API key to determine which environment the client is configured for. The API then sends ",(0,o.kt)("em",{parentName:"p"},"only"),' strategies belonging to the client\'s environment. This means that you might not need the "environment" property of the Unleash Context anymore.'),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"A strategy constraint using the environment field of the unleash context.",src:n(695).Z,title:"You will not use strategy constraints for environments any more.",width:"921",height:"188"})),(0,o.kt)("h3",{id:"addons"},"Addons"),(0,o.kt)("p",null,"We have made some slight changes to events related to feature toggles: there's one deprecation and several new event types. Most of the new events contain ",(0,o.kt)("em",{parentName:"p"},"project")," and ",(0,o.kt)("em",{parentName:"p"},"environment")," data."),(0,o.kt)("p",null,"To avoid missing important updates, you will also need to update your addon configuration to subscribe to the new events."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Deprecated events:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"FEATURE_UPDATE")," - ",(0,o.kt)("em",{parentName:"li"},"not used after switching to environments"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"New Events")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"FEATURE-METADATA-UPDATED")," - The feature toggle metadata was updated (across all environments)."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"FEATURE-STRATEGY-ADD"),"\xb9 - An activation strategy was added to a feature toggle in an environment. The ",(0,o.kt)("em",{parentName:"li"},"data")," will contain the updated strategy configuration."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"FEATURE-STRATEGY-UPDATE"),"\xb9 - An activation strategy was updated for a feature toggle. The ",(0,o.kt)("em",{parentName:"li"},"data")," will contain the updated strategy configuration."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"FEATURE-STRATEGY-REMOVE"),"\xb9 - An activation strategy was removed for a feature toggle."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"FEATURE-ENVIRONMENT-ENABLED"),"\xb9 - Signals that a feature toggle has been ",(0,o.kt)("em",{parentName:"li"},"enabled")," in a defined environment."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"FEATURE-ENVIRONMENT-DISABLED"),"\xb9 - Signals that a feature toggle has been ",(0,o.kt)("em",{parentName:"li"},"disabled")," in a defined environment."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"FEATURE-PROJECT-CHANGE"),"\xb9 - The feature toggle was moved to a new project.")),(0,o.kt)("blockquote",null,(0,o.kt)("ol",{parentName:"blockquote"},(0,o.kt)("li",{parentName:"ol"},"These feature events will contain ",(0,o.kt)("em",{parentName:"li"},"project")," and ",(0,o.kt)("em",{parentName:"li"},"environment")," as part of the event metadata."))),(0,o.kt)("h3",{id:"api"},"API"),(0,o.kt)("p",null,"In order to support configuration per environment we had to rebuild our feature toggle admin API to account for environments as well. This means that we're making the following changes to the API:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"/api/admin/features")," - ",(0,o.kt)("em",{parentName:"li"},"deprecated (scheduled for removal in Unleash v5.0). The ",(0,o.kt)("a",{parentName:"em",href:"/api/admin/features"},"old feature toggles admin API")," still works, but strategy configuration will be assumed to target the \u201cdefault\u201d environment.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"/api/admin/projects/:projectId/features")," - New feature API to be used for feature toggles which also adds support for environments. See ",(0,o.kt)("a",{parentName:"li",href:"/api/admin/feature-toggles-v2"},"the documentation")," to learn more.")),(0,o.kt)("h2",{id:"plan-differences"},"Plan Differences"),(0,o.kt)("h3",{id:"open-source-free"},"Open-Source (free)"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Will get access to two preconfigured environments: \u201cdevelopment\u201d and \u201cproduction\u201d. Existing users of Unleash will also get an additional \u201cdefault\u201d environment to simplify the adoption of environments."),(0,o.kt)("li",{parentName:"ul"},"Will be possible to turn environments on/off for all projects.")),(0,o.kt)("h3",{id:"pro-commercial"},"Pro (commercial)"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Will get access to two preconfigured environments: \u201cdevelopment\u201d and \u201cproduction\u201d. Existing users of Unleash will also get an additional \u201cdefault\u201d environment to simplify the adoption of environments."),(0,o.kt)("li",{parentName:"ul"},"Will be possible to turn environments on/off for the default project.")),(0,o.kt)("h3",{id:"enterprise-commercial"},"Enterprise (commercial)"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Will get access to two preconfigured environments: \u201cdevelopment\u201d and \u201cproduction\u201d. Existing users of Unleash will also get an additional \u201cdefault\u201d environment to simplify the adoption of environments."),(0,o.kt)("li",{parentName:"ul"},"Will be possible to turn environments on/off for all projects"),(0,o.kt)("li",{parentName:"ul"},"Will be allowed to update and remove environments."),(0,o.kt)("li",{parentName:"ul"},"Will be allowed to create new environments.")),(0,o.kt)("h2",{id:"rollout-plan"},"Rollout Plan"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Unleash v4.2")," will provide ",(0,o.kt)("em",{parentName:"li"},"early access")," to environment support. This means that it can be enabled per customer via a feature flag."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Unleash v4.3")," plans to provide general access to the environment support for all users of Unleash (Open-Source, Pro, Enterprise).")))}c.isMDXComponent=!0},1507:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/environments_api_keys-6387ceadf6eb72f1ee4fa786da1b3bba.png"},3023:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/environments_configure-0b0476a52691f82d4f07f4afba88294a.png"},2656:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/environments_overview-f02297b24677cdba3b8e3ceacfe86ba1.svg"},2981:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/environments_strategies-5884d053bff10472b2bc1456dde58dce.png"},695:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/environments_strategy_constraints-5b064d3f27ac0912c1e7ee8165cf4f11.png"}}]);