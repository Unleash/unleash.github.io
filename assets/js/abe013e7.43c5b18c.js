"use strict";(self.webpackChunkwebsitev_2=self.webpackChunkwebsitev_2||[]).push([[3767],{56056:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var a=n(87462),i=(n(67294),n(3905));const r={title:"ADR: OpenAPI SDK Generator"},o=void 0,s={unversionedId:"contributing/ADRs/front-end/sdk-generator",id:"contributing/ADRs/front-end/sdk-generator",title:"ADR: OpenAPI SDK Generator",description:"Background",source:"@site/docs/contributing/ADRs/front-end/sdk-generator.md",sourceDirName:"contributing/ADRs/front-end",slug:"/contributing/ADRs/front-end/sdk-generator",permalink:"/contributing/ADRs/front-end/sdk-generator",draft:!1,editUrl:"https://github.com/Unleash/unleash/edit/main/website/docs/contributing/ADRs/front-end/sdk-generator.md",tags:[],version:"current",frontMatter:{title:"ADR: OpenAPI SDK Generator"},sidebar:"documentation",previous:{title:"ADR: preferred styling method",permalink:"/contributing/ADRs/front-end/preferred-styling-method"},next:{title:"ADR: Domain language",permalink:"/contributing/ADRs/overarching/domain-language"}},l={},d=[{value:"Background",id:"background",level:2},{value:"Decisions",id:"decisions",level:2},{value:"Advantages",id:"advantages",level:3},{value:"Concerns",id:"concerns",level:3},{value:"Alternative packages considered",id:"alternative-packages-considered",level:2}],u={toc:d};function p(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"background"},"Background"),(0,i.kt)("p",null,"In our current frontend setup we have a lot of code that can be generated out of the OpenAPI schema. Types have not been updated in a while, and even some new features rely on hard-coded types instead of auto-generated files in ",(0,i.kt)("inlineCode",{parentName:"p"},"src/openapi"),". Fetchers and actions in the frontend involve custom-built code that is grouped in the ",(0,i.kt)("inlineCode",{parentName:"p"},"src/hooks/api")," folder. There is a separation between getters and actions. Getters use the SWR library. API actions (POST/PUT/DELETE) are grouped by feature and are exposed to components reliant on ",(0,i.kt)("inlineCode",{parentName:"p"},"useAPI")," hook."),(0,i.kt)("h2",{id:"decisions"},"Decisions"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"We will use the ",(0,i.kt)("a",{parentName:"li",href:"https://orval.dev/"},"Orval")," package to generate the typescript types for our SDK."),(0,i.kt)("li",{parentName:"ul"},"We will consider using Orval to generate the HTTP getters and actions for our SDK in the future, but will first carefully test this approach in new features under development to weed out edge cases."),(0,i.kt)("li",{parentName:"ul"},"We will deprecate ",(0,i.kt)("inlineCode",{parentName:"li"},"src/interfaces")," related to API calls and use ",(0,i.kt)("inlineCode",{parentName:"li"},"src/openapi")," models instead.")),(0,i.kt)("h3",{id:"advantages"},"Advantages"),(0,i.kt)("p",null,"SDK generated out of it will be better than what we have right now. It will help reduce the risk of duplication and inconsistencies in our SDK, as it will be generated from a single source of truth."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"We retain the flexibility of previous solution, because we can implement our own ",(0,i.kt)("em",{parentName:"li"},"fetcher")," function, and substitute ",(0,i.kt)("em",{parentName:"li"},"response")," and ",(0,i.kt)("em",{parentName:"li"},"error")," type generics. See ",(0,i.kt)("a",{parentName:"li",href:"https://orval.dev/guides/custom-client"},"https://orval.dev/guides/custom-client")),(0,i.kt)("li",{parentName:"ul"},"It supports ",(0,i.kt)("inlineCode",{parentName:"li"},"anyOf")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"oneOf")," schema, which the previous generator did not support."),(0,i.kt)("li",{parentName:"ul"},"If we decide to use Orval to generate the HTTP getters and actions for our SDK, it will reduce the amount of boilerplate code required when working with the new APIs.")),(0,i.kt)("h3",{id:"concerns"},"Concerns"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"We will need to ensure that we keep our OpenAPI specification up-to-date, as any changes in the specification will be reflected in the generated SDK. We need an enterprise version with all experimental endpoints enabled to get complete output."),(0,i.kt)("li",{parentName:"ul"},"Orval is well-maintained, but it appears to have just 1 core contributor. SDK is a very important thing and should be reliable."),(0,i.kt)("li",{parentName:"ul"},"We can revert to writing some API calls by hand if this approach is not flexible enough, but this can cause issues negating the benefits of code generation.")),(0,i.kt)("h2",{id:"alternative-packages-considered"},"Alternative packages considered"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@openapitools/openapi-generator")," - does not offer as many customization options as Orval. It struggles with ",(0,i.kt)("inlineCode",{parentName:"li"},"anyOf")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"oneOf")," types. It fails "),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rapini"),": This package is less flexible and less actively maintained than Orval, and we therefore decided against it."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@openapi-codegen")," - does not generate SWR hooks")))}p.isMDXComponent=!0}}]);