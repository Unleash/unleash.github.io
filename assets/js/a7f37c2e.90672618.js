"use strict";(self.webpackChunkwebsitev_2=self.webpackChunkwebsitev_2||[]).push([[5502],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(n),m=i,h=c["".concat(l,".").concat(m)]||c[m]||d[m]||r;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},8688:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return u},default:function(){return c}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),o=["components"],s={id:"unleash_context",title:"Unleash Context"},l=void 0,p={unversionedId:"user_guide/unleash_context",id:"user_guide/unleash_context",title:"Unleash Context",description:"The Unleash Context contains information relating to the current feature toggle request. Unleash uses this context to evaluate activation strategies and strategy constraints and to calculate toggle stickiness. The Unleash Context is an important feature of all the Unleash client SDKs.",source:"@site/docs/user_guide/unleash-context.md",sourceDirName:"user_guide",slug:"/user_guide/unleash_context",permalink:"/user_guide/unleash_context",editUrl:"https://github.com/Unleash/unleash/edit/main/website/docs/user_guide/unleash-context.md",tags:[],version:"current",frontMatter:{id:"unleash_context",title:"Unleash Context"},sidebar:"documentation",previous:{title:"Technical Debt",permalink:"/user_guide/technical_debt"},next:{title:"Unleash Proxy",permalink:"/sdks/unleash-proxy"}},u=[{value:"Structure",id:"structure",children:[{value:"The <code>properties</code> field",id:"the-properties-field",children:[{value:"A note on properties and constraints",id:"a-note-on-properties-and-constraints",children:[],level:4}],level:3}],level:2},{value:"Custom context fields",id:"custom-context-fields",children:[{value:"Creating and updating custom context fields",id:"creating-and-updating-custom-context-fields",children:[],level:3},{value:"Legal values",id:"legal-values",children:[],level:3},{value:"Custom stickiness",id:"custom-stickiness",children:[],level:3}],level:2}],d={toc:u};function c(e){var t=e.components,s=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The ",(0,r.kt)("strong",{parentName:"p"},"Unleash Context")," contains information relating to the current feature toggle request. Unleash uses this context to evaluate ",(0,r.kt)("a",{parentName:"p",href:"/user_guide/activation_strategy"},"activation strategies")," and ",(0,r.kt)("a",{parentName:"p",href:"/advanced/strategy_constraints"},"strategy constraints")," and to calculate ",(0,r.kt)("a",{parentName:"p",href:"/advanced/stickiness"},"toggle stickiness"),". The Unleash Context is an important feature of all the ",(0,r.kt)("a",{parentName:"p",href:"/sdks"},"Unleash client SDKs"),"."),(0,r.kt)("h2",{id:"structure"},"Structure"),(0,r.kt)("p",null,"You can group the Unleash Context fields into two separate groups based on how they work in the client SDKs: ",(0,r.kt)("strong",{parentName:"p"},"static"),"  and ",(0,r.kt)("strong",{parentName:"p"},"dynamic")," context fields."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Static")," fields' values remain constant throughout an application's lifetime. You'll typically set these when you initialize the client SDK."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Dynamic")," fields, however, can change with every request. You'll typically provide these when checking whether a toggle is enabled in your client."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"All fields are optional"),", but some strategies depend on certain fields being present. For instance, ",(0,r.kt)("a",{parentName:"p",href:"/user_guide/activation_strategy#userids"},"the UserIDs strategy")," requires that the ",(0,r.kt)("inlineCode",{parentName:"p"},"userId")," field is present on the Context."),(0,r.kt)("p",null,"The below table gives a brief overview over what the fields' intended usage is, their lifetime, and their type. Note that the exact type can vary between programming languages and implementations. Be sure to consult your specific client SDK for more information on its implementation of the Unleash Context."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"field name"),(0,r.kt)("th",{parentName:"tr",align:null},"type"),(0,r.kt)("th",{parentName:"tr",align:null},"lifetime"),(0,r.kt)("th",{parentName:"tr",align:null},"description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"appName")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"static"),(0,r.kt)("td",{parentName:"tr",align:null},"the name of the application")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"environment"),(0,r.kt)("sup",{parentName:"td",id:"fnref-1"},(0,r.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"static"),(0,r.kt)("td",{parentName:"tr",align:null},"the environment the app is running in")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"userId")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"dynamic"),(0,r.kt)("td",{parentName:"tr",align:null},"an identifier for the current user")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"sessionId")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"dynamic"),(0,r.kt)("td",{parentName:"tr",align:null},"an identifier for the current session")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"remoteAddress")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"dynamic"),(0,r.kt)("td",{parentName:"tr",align:null},"an identifier for the current session")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"properties")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Map<string, string>")),(0,r.kt)("td",{parentName:"tr",align:null},"dynamic"),(0,r.kt)("td",{parentName:"tr",align:null},"a key-value store of any data you want")))),(0,r.kt)("h3",{id:"the-properties-field"},"The ",(0,r.kt)("inlineCode",{parentName:"h3"},"properties")," field"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"properties")," field is different from the others. You can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"properties")," field to provide arbitrary data to ",(0,r.kt)("a",{parentName:"p",href:"/advanced/custom_activation_strategy"},"custom strategies")," or to ",(0,r.kt)("a",{parentName:"p",href:"/advanced/strategy_constraints"},"strategy constraints"),". The ",(0,r.kt)("inlineCode",{parentName:"p"},"properties")," field is also where you add values for ",(0,r.kt)("a",{parentName:"p",href:"#custom-context-fields"},"custom context fields"),"."),(0,r.kt)("h4",{id:"a-note-on-properties-and-constraints"},"A note on properties and constraints"),(0,r.kt)("p",null,"Some SDK implementations of the Unleash Context allow for the values in the ",(0,r.kt)("inlineCode",{parentName:"p"},"properties")," map to be of other types than a string type. Using non-string types as values may cause issues if you're using the property in a constraint. Because the Unleash Admin UI accepts any string as input for constraint checking, the SDKs must also assume that the value is a string."),(0,r.kt)("p",null,"As an example: You've created a custom field called ",(0,r.kt)("inlineCode",{parentName:"p"},"groupId"),". You know group IDs will always be numeric. You then create a constraint on a strategy that says the user must be in group ",(0,r.kt)("inlineCode",{parentName:"p"},"123456"),". If you were to set the property ",(0,r.kt)("inlineCode",{parentName:"p"},"groupId")," to the number ",(0,r.kt)("inlineCode",{parentName:"p"},"123456")," in the ",(0,r.kt)("inlineCode",{parentName:"p"},"properties")," field on the SDK side, the constraint check would fail, because in most languages the number ",(0,r.kt)("inlineCode",{parentName:"p"},"123456")," is not equal to the string ",(0,r.kt)("inlineCode",{parentName:"p"},"123456")," (i.e. ",(0,r.kt)("inlineCode",{parentName:"p"},'123456 != "123456"'),")."),(0,r.kt)("h2",{id:"custom-context-fields"},"Custom context fields"),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Availability")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Custom context fields are available to Pro and Enterprise users."))),(0,r.kt)("p",null,"Custom context fields allow you to extend the Unleash Context with more data that is applicable to your situation. Each context field definition consists of a name and an optional description. Additionally, you can choose to define a set of ",(0,r.kt)("a",{parentName:"p",href:"#legal-values",title:"legal values for custom context fields"},(0,r.kt)("em",{parentName:"a"},"legal values")),", and you can choose whether or not the context field can be used in ",(0,r.kt)("a",{parentName:"p",href:"/advanced/stickiness#custom-stickiness"},"custom stickiness calculations")," for the ",(0,r.kt)("a",{parentName:"p",href:"/user_guide/activation_strategy#customize-stickiness-beta"},"gradual rollout strategy")," and for ",(0,r.kt)("a",{parentName:"p",href:"/advanced/toggle_variants"},"feature toggle variants"),"."),(0,r.kt)("p",null,"When interacting with custom context fields in code, they must be accessed via the Unleash Context's ",(0,r.kt)("inlineCode",{parentName:"p"},"properties")," map, using the context field's name as the key."),(0,r.kt)("h3",{id:"creating-and-updating-custom-context-fields"},"Creating and updating custom context fields"),(0,r.kt)("p",null,"You can create as many custom context fields as you wish. Refer to ",(0,r.kt)("a",{parentName:"p",href:"../how-to/how-to-define-custom-context-fields"},'"how to define custom context fields"')," for information on how you define your own custom context fields."),(0,r.kt)("p",null,"You can update custom context fields after they have been created. You can change everything about the definition except for the name."),(0,r.kt)("h3",{id:"legal-values"},"Legal values"),(0,r.kt)("p",null,"By using the ",(0,r.kt)("strong",{parentName:"p"},"legal values")," option when creating a context field, you can create a set of valid options for a context field's values.\nIf a context field has a defined set of legal values, the Unleash Admin UI will only allow users to enter one or more of the specified values. If a context field ",(0,r.kt)("em",{parentName:"p"},"doesn't")," have any defined legal values, the user can enter whatever they want."),(0,r.kt)("p",null,"Using a custom context field called ",(0,r.kt)("em",{parentName:"p"},"region")," as an example: if you define the field's legal values as ",(0,r.kt)("em",{parentName:"p"},"Africa"),", ",(0,r.kt)("em",{parentName:"p"},"Asia"),", ",(0,r.kt)("em",{parentName:"p"},"Europe"),", and ",(0,r.kt)("em",{parentName:"p"},"North America"),", then you would only be allowed to use one or more of those four values when using the custom context field as a ",(0,r.kt)("a",{parentName:"p",href:"/advanced/strategy_constraints"},"strategy constraint"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"A strategy constraint form with a constraint set to &quot;region&quot;. The &quot;values&quot; input is a dropdown menu containing the options &quot;Africa&quot;, &quot;Asia&quot;, &quot;Europe&quot;, and &quot;North America&quot;, as defined in the preceding paragraph.",src:n(8713).Z})),(0,r.kt)("h3",{id:"custom-stickiness"},"Custom stickiness"),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"This feature is currently in beta and is not yet supported by all our SDKs. Check out the ",(0,r.kt)("a",{parentName:"p",href:"/sdks#server-side-sdk-compatibility-table"},"SDK compatibility table")," to see what SDKs support it at the moment."))),(0,r.kt)("p",null,"Any context field ",(0,r.kt)("em",{parentName:"p"},"can")," be used to ",(0,r.kt)("a",{parentName:"p",href:"/advanced/stickiness#custom-stickiness"},"calculate custom stickiness"),". However, you need to explicitly tell Unleash that you want a field to be used for custom stickiness for it to be possible. You can enable this functionality either when you create the context field or at any later point. For steps on how to do this, see ",(0,r.kt)("a",{parentName:"p",href:"../how-to/how-to-define-custom-context-fields"},"the ",(0,r.kt)("em",{parentName:"a"},"How to define custom context fields")," guide"),"."),(0,r.kt)("div",{className:"footnotes"},(0,r.kt)("hr",{parentName:"div"}),(0,r.kt)("ol",{parentName:"div"},(0,r.kt)("li",{parentName:"ol",id:"fn-1"},"If you're on Unleash 4.3 or higher, you'll probably want to use ",(0,r.kt)("a",{parentName:"li",href:"/user_guide/environments"},"the environments feature")," instead of relying on the ",(0,r.kt)("inlineCode",{parentName:"li"},"environment")," context field when working with environments.",(0,r.kt)("a",{parentName:"li",href:"#fnref-1",className:"footnote-backref"},"\u21a9")))))}c.isMDXComponent=!0},8713:function(e,t,n){t.Z=n.p+"assets/images/constraints_legal_values-fdd1ef7f27cda840b707ae89046900e5.png"}}]);