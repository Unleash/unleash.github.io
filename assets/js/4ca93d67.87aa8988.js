"use strict";(self.webpackChunkwebsitev_2=self.webpackChunkwebsitev_2||[]).push([[3594],{9351:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return s},default:function(){return u},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return d}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),o=["components"],l={title:"Impression data"},s=void 0,p={unversionedId:"advanced/impression-data",id:"advanced/impression-data",title:"Impression data",description:"The impression data feature was introduced in Unleash 4.7. Listening for events requires an SDK that supports impression data events. Currently, it's only supported in the Unleash Proxy client and React Proxy client.",source:"@site/docs/advanced/impression-data.md",sourceDirName:"advanced",slug:"/advanced/impression-data",permalink:"/advanced/impression-data",editUrl:"https://github.com/Unleash/unleash/edit/main/website/docs/advanced/impression-data.md",tags:[],version:"current",frontMatter:{title:"Impression data"},sidebar:"documentation",previous:{title:"The audit log",permalink:"/advanced/audit_log"},next:{title:"Custom Activation Strategies",permalink:"/advanced/custom_activation_strategy"}},d=[{value:"Impression event data",id:"impression-event-data",children:[{value:"Example <code>isEnabled</code>  event",id:"example-isenabled",children:[],level:3},{value:"Example <code>getVariant</code> event",id:"example-getvariant",children:[],level:3}],level:2},{value:"Enabling impression data",id:"enabling-impression-data",children:[],level:2},{value:"Example setup",id:"example-setup",children:[],level:2}],m={toc:d};function u(e){var t=e.components,l=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},m,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Availability")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The impression data feature was introduced in ",(0,i.kt)("strong",{parentName:"p"},"Unleash 4.7"),". Listening for events requires ",(0,i.kt)("a",{parentName:"p",href:"/sdks#server-side-sdk-compatibility-table"},"an SDK that supports impression data events"),". Currently, it's only supported in the ",(0,i.kt)("a",{parentName:"p",href:"/sdks/proxy-javascript"},"Unleash Proxy client")," and ",(0,i.kt)("a",{parentName:"p",href:"/sdks/proxy-react"},"React Proxy client"),"."))),(0,i.kt)("p",null,"Unleash can provide you with ",(0,i.kt)("strong",{parentName:"p"},"impression data")," about the toggles in your application. Impression data contains information about a specific feature toggle activation check: The client SDK will emit an ",(0,i.kt)("strong",{parentName:"p"},"impression event")," whenever it calls ",(0,i.kt)("inlineCode",{parentName:"p"},"isEnabled")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"getVariant"),"."),(0,i.kt)("p",null,"Impression data was designed to make it easier for you to ",(0,i.kt)("strong",{parentName:"p"},"collect analytics data"),", ",(0,i.kt)("strong",{parentName:"p"},"perform A/B tests"),", and ",(0,i.kt)("strong",{parentName:"p"},"enrich experiments")," in your applications. It contains information about the feature toggle and the related ",(0,i.kt)("a",{parentName:"p",href:"/user_guide/unleash_context"},"Unleash Context"),"."),(0,i.kt)("p",null,"Impression data is ",(0,i.kt)("strong",{parentName:"p"},"opt-in on a per-toggle basis"),". Unleash will not emit impression events for toggles not marked as such. Once you've turned impression data on for a toggle, you can start listening for impression events in your client SDK."),(0,i.kt)("h2",{id:"impression-event-data"},"Impression event data"),(0,i.kt)("p",null,"There's two types of impression events you can listen for:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#example-isenabled"},(0,i.kt)("inlineCode",{parentName:"a"},"isEnabled")," events")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#example-getvariant"},(0,i.kt)("inlineCode",{parentName:"a"},"getVariant")," events"))),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"getVariant")," event contains all the information found in an ",(0,i.kt)("inlineCode",{parentName:"p"},"isEnabled")," event in addition to extra data that's only relevant to ",(0,i.kt)("inlineCode",{parentName:"p"},"getVariant")," calls."),(0,i.kt)("p",null,"This table describes all the properties on the impression events:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Property name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Event type"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"eventType")),(0,i.kt)("td",{parentName:"tr",align:null},"The type of the event: ",(0,i.kt)("inlineCode",{parentName:"td"},"isEnabled")," or ",(0,i.kt)("inlineCode",{parentName:"td"},"getVariant")),(0,i.kt)("td",{parentName:"tr",align:null},"All")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"eventId")),(0,i.kt)("td",{parentName:"tr",align:null},"A globally unique id (GUID) assigned to this event."),(0,i.kt)("td",{parentName:"tr",align:null},"All")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"context")),(0,i.kt)("td",{parentName:"tr",align:null},"A representation of the current ",(0,i.kt)("a",{parentName:"td",href:"/user_guide/unleash_context"},"Unleash Context"),"."),(0,i.kt)("td",{parentName:"tr",align:null},"All")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"enabled")),(0,i.kt)("td",{parentName:"tr",align:null},"Whether the toggle was enabled or not at when the client made the request."),(0,i.kt)("td",{parentName:"tr",align:null},"All")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"featureName")),(0,i.kt)("td",{parentName:"tr",align:null},"The name of the feature toggle."),(0,i.kt)("td",{parentName:"tr",align:null},"All")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"variant")),(0,i.kt)("td",{parentName:"tr",align:null},"The name of the active variant"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"getVariant")," events only")))),(0,i.kt)("h3",{id:"example-isenabled"},"Example ",(0,i.kt)("inlineCode",{parentName:"h3"},"isEnabled"),"  event"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"{\n  eventType: 'isEnabled',\n  eventId: '84b41a43-5ba0-47d8-b21f-a60a319607b0',\n  context: {\n    sessionId: 54085233,\n    appName: 'my-webapp',\n    environment: 'default'\n  },\n  enabled: true,\n  featureName: 'my-feature-toggle',\n}\n")),(0,i.kt)("h3",{id:"example-getvariant"},"Example ",(0,i.kt)("inlineCode",{parentName:"h3"},"getVariant")," event"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"{\n  eventType: 'getVariant',\n  eventId: '84b41a43-5ba0-47d8-b21f-a60a319607b0',\n  context: {\n    sessionId: 54085233,\n    appName: 'my-webapp',\n    environment: 'default'\n  },\n  enabled: true,\n  featureName: 'my-feature-toggle',\n  variant: 'variantA'\n}\n")),(0,i.kt)("h2",{id:"enabling-impression-data"},"Enabling impression data"),(0,i.kt)("p",null,"Impression data is strictly an ",(0,i.kt)("strong",{parentName:"p"},"opt-in")," feature and must be enabled on a ",(0,i.kt)("strong",{parentName:"p"},"per-toggle basis"),".\nYou can enable and disable it both when you create a toggle and when you edit a toggle."),(0,i.kt)("p",null,"You can enable impression data via the impression data toggle in the admin UI's toggle creation form. You can also go via the ",(0,i.kt)("a",{parentName:"p",href:"/api/admin/feature-toggles-v2#create-toggle"},"the API, using the ",(0,i.kt)("inlineCode",{parentName:"a"},"impressionData")," option"),". For more detailed instructions, see ",(0,i.kt)("a",{parentName:"p",href:"/how-to/how-to-capture-impression-data#step-1"},"the section on enabling impression data in the how-to guide for capturing impression data"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"A feature toggle creation form. At the end of the form is a heading that says &quot;Impression data&quot;, a short paragraph that describes the feature, and a toggle to opt in or out of it.",src:n(8451).Z,width:"3752",height:"2650"})),(0,i.kt)("h2",{id:"example-setup"},"Example setup"),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"This functionality is currently only supported in the ",(0,i.kt)("a",{parentName:"p",href:"/sdks/proxy-javascript"},"Unleash Proxy client")," and ",(0,i.kt)("a",{parentName:"p",href:"/sdks/proxy-react"},"React Proxy client"),"."))),(0,i.kt)("p",null,"The exact setup will vary depending on your ",(0,i.kt)("a",{parentName:"p",href:"/sdks"},"client SDK"),". The below example configures the ",(0,i.kt)("a",{parentName:"p",href:"/sdks/proxy-javascript"},"Unleash Proxy client"),' to listen for impression events and log them to the console. If "my-feature-toggle" is configured to emit impression data, then it will trigger an impression event as soon as Unleash is ready.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const unleash = new UnleashClient({\n  url: 'https://eu.unleash-hosted.com/hosted/proxy',\n  clientKey: 'your-proxy-key',\n  appName: 'my-webapp',\n});\n\nunleash.start();\n\nunleash.on(\"ready\", () => {\n  unleash.isEnabled(\"my-feature-toggle\");\n})\n\nunleash.on(\"impression\", (event) => {\n  // Capture the event here and pass it internal data lake or analytics provider\n  console.log(event);\n})\n")))}u.isMDXComponent=!0},3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return c}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(n),c=r,h=u["".concat(s,".").concat(c)]||u[c]||m[c]||i;return n?a.createElement(h,o(o({ref:t},d),{},{components:n})):a.createElement(h,o({ref:t},d))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8451:function(e,t,n){t.Z=n.p+"assets/images/create_feat_impression-f9c705a78b4c6ddd2cb97c9d6f638a3a.png"}}]);