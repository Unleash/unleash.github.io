"use strict";(self.webpackChunkwebsitev_2=self.webpackChunkwebsitev_2||[]).push([[918],{3905:function(e,t,r){r.d(t,{Zo:function(){return s},kt:function(){return c}});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var p=a.createContext({}),u=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},s=function(e){var t=u(e.components);return a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=u(r),c=n,f=m["".concat(p,".").concat(c)]||m[c]||d[c]||o;return r?a.createElement(f,i(i({ref:t},s),{},{components:r})):a.createElement(f,i({ref:t},s))}));function c(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var u=2;u<o;u++)i[u]=r[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},9333:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return l},contentTitle:function(){return p},metadata:function(){return u},toc:function(){return s},default:function(){return m}});var a=r(7462),n=r(3366),o=(r(7294),r(3905)),i=["components"],l={id:"import_export",title:"Import & Export"},p=void 0,u={unversionedId:"deploy/import_export",id:"deploy/import_export",isDocsHomePage:!1,title:"Import & Export",description:"since v3.3.0",source:"@site/docs/deploy/import-export.md",sourceDirName:"deploy",slug:"/deploy/import_export",permalink:"/deploy/import_export",editUrl:"https://github.com/Unleash/unleash/edit/master/websitev2/docs/deploy/import-export.md",version:"current",frontMatter:{id:"import_export",title:"Import & Export"},sidebar:"Deploy and manage",previous:{title:"Migration Guide",permalink:"/deploy/migration_guide"}},s=[{value:"Runtime import &amp; export",id:"runtime-import--export",children:[{value:"State Service",id:"state-service",children:[]},{value:"API Export",id:"api-export",children:[]},{value:"API Import",id:"api-import",children:[]}]},{value:"Startup import",id:"startup-import",children:[{value:"Import files via config parameter",id:"import-files-via-config-parameter",children:[]}]}],d={toc:s};function m(e){var t=e.components,r=(0,n.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"since v3.3.0")),(0,o.kt)("p",null,"Unleash supports import and export of feature-toggles and strategies at startup and during runtime. The import mechanism will guarantee that all imported features will be non-archived, as well as updates to strategies and features are included in the event history."),(0,o.kt)("p",null,"All import mechanisms support a ",(0,o.kt)("inlineCode",{parentName:"p"},"drop")," parameter which will clean the database before import (all strategies and features will be removed)."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"You should be careful when using ",(0,o.kt)("inlineCode",{parentName:"p"},"drop")," parameter in production environments, as it will clean current state.")),(0,o.kt)("h2",{id:"runtime-import--export"},"Runtime import & export"),(0,o.kt)("h3",{id:"state-service"},"State Service"),(0,o.kt)("p",null,"Unleash returns a StateService when started, you can use this to import and export data at any time."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const unleash = require('unleash-server');\n\nconst { services } = await unleash.start({...});\nconst { stateService } = services;\n\nconst exportedData = await stateService.export({includeStrategies: false, includeFeatureToggles: true, includeTags: true, includeProjects: true});\n\nawait stateService.import({data: exportedData, userName: 'import', dropBeforeImport: false});\n\nawait stateService.importFile({file: 'exported-data.yml', userName: 'import', dropBeforeImport: true})\n")),(0,o.kt)("p",null,"If you want the database to be cleaned before import (all strategies and features will be removed), set the ",(0,o.kt)("inlineCode",{parentName:"p"},"dropBeforeImport")," parameter."),(0,o.kt)("p",null,"It is also possible to not override exiting feature toggles (and strategies) by using the ",(0,o.kt)("inlineCode",{parentName:"p"},"keepExisting")," parameter."),(0,o.kt)("h3",{id:"api-export"},"API Export"),(0,o.kt)("p",null,"The api endpoint ",(0,o.kt)("inlineCode",{parentName:"p"},"/api/admin/state/export")," will export feature-toggles and strategies as json by default.\\\nYou can customize the export with query parameters:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,o.kt)("th",{parentName:"tr",align:null},"Default"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"format"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"json")),(0,o.kt)("td",{parentName:"tr",align:null},"Export format, either ",(0,o.kt)("inlineCode",{parentName:"td"},"json")," or ",(0,o.kt)("inlineCode",{parentName:"td"},"yaml"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"download"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"false")),(0,o.kt)("td",{parentName:"tr",align:null},"If the exported data should be downloaded as a file")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"featureToggles"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"true")),(0,o.kt)("td",{parentName:"tr",align:null},"Include feature-toggles in the exported data")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"strategies"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"true")),(0,o.kt)("td",{parentName:"tr",align:null},"Include strategies in the exported data")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"tags"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"true")),(0,o.kt)("td",{parentName:"tr",align:null},"Include tagtypes, tags and feature_tags in the exported data")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"projects"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"true")),(0,o.kt)("td",{parentName:"tr",align:null},"Include projects in the exported data")))),(0,o.kt)("p",null,"For example if you want to download just feature-toggles as yaml:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"/api/admin/state/export?format=yaml&featureToggles=1&strategies=0&tags=0&projects=0&download=1\n")),(0,o.kt)("p",null,"Example with curl:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'curl -X GET -H "Content-Type: application/json" \\\n  -H "Authorization: Basic YWRtaW46" \\\n  http://unleash.herokuapp.com/api/admin/state/export?&featureToggles=1&strategies=0 > export.json\n')),(0,o.kt)("h3",{id:"api-import"},"API Import"),(0,o.kt)("p",null,"You can import feature-toggles and strategies by POSTing to the ",(0,o.kt)("inlineCode",{parentName:"p"},"/api/admin/state/import")," endpoint (keep in mind this will require authentication).\\\nYou can either send the data as JSON in the POST-body or send a ",(0,o.kt)("inlineCode",{parentName:"p"},"file")," parameter with ",(0,o.kt)("inlineCode",{parentName:"p"},"multipart/form-data")," (YAML files are also accepted here)."),(0,o.kt)("p",null,"If you want the database to be cleaned before import (all strategies and features will be removed), specify a ",(0,o.kt)("inlineCode",{parentName:"p"},"drop")," query parameter."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"You should never use this in production environments.")),(0,o.kt)("p",null,"Example usage:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'POST /api/admin/state/import\n{\n    "features": [\n        {\n            "name": "a-feature-toggle",\n            "enabled": true,\n            "description": "#1 feature-toggle"\n        }\n    ]\n}\n')),(0,o.kt)("p",null,"Example with curl:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'curl -X POST -H "Content-Type: application/json" \\\n  -H "Authorization: Basic YWRtaW46" -d @export.json \\\n  http://localhost:4242/api/admin/state/import\n')),(0,o.kt)("p",null,"*",") Remember to set correct token for Authorization."),(0,o.kt)("h2",{id:"startup-import"},"Startup import"),(0,o.kt)("h3",{id:"import-files-via-config-parameter"},"Import files via config parameter"),(0,o.kt)("p",null,"You can import a json or yaml file via the configuration option ",(0,o.kt)("inlineCode",{parentName:"p"},"importFile"),"."),(0,o.kt)("p",null,"Example usage: ",(0,o.kt)("inlineCode",{parentName:"p"},"unleash-server --databaseUrl ... --importFile export.yml"),"."),(0,o.kt)("p",null,"If you want the database to be cleaned before import (all strategies and features will be removed), specify the ",(0,o.kt)("inlineCode",{parentName:"p"},"dropBeforeImport")," option."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"You should never use this in production environments.")),(0,o.kt)("p",null,"Example usage: ",(0,o.kt)("inlineCode",{parentName:"p"},"unleash-server --databaseUrl ... --importFile export.yml --dropBeforeImport"),"."),(0,o.kt)("p",null,"These options can also be passed into the ",(0,o.kt)("inlineCode",{parentName:"p"},"unleash.start()")," entrypoint."))}m.isMDXComponent=!0}}]);